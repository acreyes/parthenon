<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coordinates &mdash; Parthenon  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parthenon developer guide" href="development.html" />
    <link rel="prev" title="Parthenon Built-in Physical Constants" href="constants.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Parthenon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="amr.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html">Boundary communication-in-one concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html#sparse-boundary-communication">Sparse boundary communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts_lite.html">C++11 Style Concepts Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Parthenon Built-in Physical Constants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Coordinates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#compile-time-vs-run-time-parameters">Compile Time vs. Run Time Parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Parthenon developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Application Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrumentation.html">Performance Instrumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_balancing.html">Load Balancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="nested_par_for.html">Nested Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html">Parthenon Set-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html#parthenon-arbitrary-dimensional-arrays">Parthenon Arbitrary-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_manager.html">Parthenon Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="reductions.html">Task-based reductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx-doc.html">How to Use Sphinx for Writing Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">How to add tests to Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak_scaling.html">Running a Weak Scaling Test in Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/boundary.html">Boundary related classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/refinement_operations.html">Prolongation and Restriction Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/sparse.html">Sparse implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/state.html">State Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/mesh.html">Mesh</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Parthenon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Coordinates</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/coordinates.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="coordinates">
<span id="id1"></span><h1>Coordinates<a class="headerlink" href="#coordinates" title="Link to this heading"></a></h1>
<p><em>Parthenon currently provides a coordinates class ``UniformCartesian``
for a uniform Cartesian coordinate system. In the near future we will
provide uniform spherical and uniform cylindrical coordinate systems.
Other coordinate systems may be implemented in downstream codes.
Alternatively, coordinate systems can be incorporated in the fluid
equations such as is done
in</em><a class="reference external" href="https://github.com/lanl/phoebus">Phoebus</a><em>.</em></p>
<p>Coordinate objects under the <code class="docutils literal notranslate"><span class="pre">Coordinates_t</span></code> type are created for each
meshblock. Coordinate information such as positions of different
elements within each cell (cell centers, face centers, edge centers, and
nodes), distance between elements, and integration elements (cell
widths, edge centers, face areas, and cell volumes) can be accessed from
the coordinate object for each meshblock. The coordinates object for
meshblock <code class="docutils literal notranslate"><span class="pre">b</span></code> in a variable pack <code class="docutils literal notranslate"><span class="pre">var_pack</span></code> can be accessed via
<code class="docutils literal notranslate"><span class="pre">var_pack.GetCoords(b)</span></code>.</p>
<p>The interface for coordinate systems is derived from Athena++ but with
new names and with directions, faces, and edges specified by either
template parameters at compile time or arguments at run time instead of
with different function names. For ease of conversion from Athena++, we
summarize the new coordinate functions with their Athena++ predecessors.</p>
<p>Position of elements (replacing <code class="docutils literal notranslate"><span class="pre">x1v</span></code>, <code class="docutils literal notranslate"><span class="pre">x1f</span></code>, <code class="docutils literal notranslate"><span class="pre">x1s2</span></code> etc. in
Athena++)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Xc</span><span class="o">&lt;</span><span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Cell</span> <span class="n">Centers</span>
<span class="n">Xf</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">face</span><span class="p">,</span> <span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Face</span> <span class="n">Centers</span>
<span class="n">Xe</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">edge</span><span class="p">,</span> <span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Edge</span> <span class="n">Centers</span>
<span class="n">Xn</span><span class="o">&lt;</span> <span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Cell</span> <span class="n">Nodes</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">1&lt;=dir&lt;=3</span></code> is which component of the direction being queried
(i.e. x,y,z), <code class="docutils literal notranslate"><span class="pre">face</span></code> and <code class="docutils literal notranslate"><span class="pre">edge</span></code> specify which face/edge is being
queried, and <code class="docutils literal notranslate"><span class="pre">idx</span></code> is the index along <code class="docutils literal notranslate"><span class="pre">dir</span></code>. For the function
<code class="docutils literal notranslate"><span class="pre">Xf</span></code>, when <code class="docutils literal notranslate"><span class="pre">dir==face</span></code> it gives the same face position as <code class="docutils literal notranslate"><span class="pre">x1f</span></code>,
<code class="docutils literal notranslate"><span class="pre">x2f</span></code>, and <code class="docutils literal notranslate"><span class="pre">x3f</span></code> in Athena++. When <code class="docutils literal notranslate"><span class="pre">dir!=face</span></code>, it returns the
face-average position, lying within the plane of the face, which
replaces <code class="docutils literal notranslate"><span class="pre">x1s2</span></code>, <code class="docutils literal notranslate"><span class="pre">x1s3</span></code>, <code class="docutils literal notranslate"><span class="pre">x2s1</span></code>, <code class="docutils literal notranslate"><span class="pre">x2s3</span></code>, <code class="docutils literal notranslate"><span class="pre">x3s1</span></code>, and <code class="docutils literal notranslate"><span class="pre">x3s2</span></code>
in Athena++. <code class="docutils literal notranslate"><span class="pre">Xe</span></code> and <code class="docutils literal notranslate"><span class="pre">Xn</span></code> have no equivalents in Athena++ put
return the positions of off-cell-center locations consistent with these
positions computed from cell-centers and face-centers in Athena++.</p>
<p>Distance between elements (previously <code class="docutils literal notranslate"><span class="pre">dx1v</span></code>, <code class="docutils literal notranslate"><span class="pre">dx1f</span></code> etc. )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dxc</span><span class="o">&lt;</span><span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Distance</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">centers</span> <span class="n">along</span> <span class="nb">dir</span>
<span class="n">Dxf</span><span class="o">&lt;</span><span class="nb">int</span> <span class="nb">dir</span><span class="p">,</span> <span class="nb">int</span> <span class="n">face</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Distance</span> <span class="n">between</span> <span class="n">face</span> <span class="n">centers</span> <span class="n">along</span> <span class="nb">dir</span>
<span class="n">Dxe</span><span class="o">&lt;</span><span class="nb">int</span> <span class="nb">dir</span><span class="p">,</span> <span class="nb">int</span> <span class="n">edge</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Distance</span> <span class="n">between</span> <span class="n">edge</span> <span class="n">centers</span> <span class="n">along</span> <span class="nb">dir</span>
<span class="n">Dxn</span><span class="o">&lt;</span> <span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">idx</span><span class="p">);</span> <span class="o">//</span><span class="n">Distance</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">Nodes</span> <span class="n">along</span> <span class="nb">dir</span>
</pre></div>
</div>
<p>Likewise, <code class="docutils literal notranslate"><span class="pre">face</span></code>, <code class="docutils literal notranslate"><span class="pre">edge</span></code>, <code class="docutils literal notranslate"><span class="pre">Dxe</span></code>, and <code class="docutils literal notranslate"><span class="pre">Dxn</span></code> are new to get
distances between different elements along different dimensions.</p>
<p>Integration elements (replacing <code class="docutils literal notranslate"><span class="pre">CenterWidth1</span></code>, <code class="docutils literal notranslate"><span class="pre">Edge1Length</span></code>,
<code class="docutils literal notranslate"><span class="pre">Face1Area</span></code>, and <code class="docutils literal notranslate"><span class="pre">CellVolume</span></code>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CellWidth</span><span class="o">&lt;</span><span class="nb">int</span> <span class="nb">dir</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">i</span><span class="p">);</span> <span class="o">//</span><span class="n">Cell</span> <span class="n">Width</span> <span class="n">at</span> <span class="n">cell</span> <span class="n">center</span>
<span class="n">FaceArea</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">face</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">i</span><span class="p">);</span> <span class="o">//</span><span class="n">Area</span> <span class="n">of</span> <span class="n">Face</span>
<span class="n">EdgeLength</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">edge</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">i</span><span class="p">);</span> <span class="o">//</span><span class="n">Length</span> <span class="n">of</span> <span class="n">edge</span>
<span class="n">CellVolume</span><span class="p">(</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">i</span><span class="p">);</span> <span class="o">//</span><span class="n">CellVolume</span>
</pre></div>
</div>
<p>These functions take all three indices to accommodate extension to
spherical and cylindrical.</p>
<section id="compile-time-vs-run-time-parameters">
<h2>Compile Time vs. Run Time Parameters<a class="headerlink" href="#compile-time-vs-run-time-parameters" title="Link to this heading"></a></h2>
<p>For each of these functions that take parameters <code class="docutils literal notranslate"><span class="pre">dir</span></code>, <code class="docutils literal notranslate"><span class="pre">face</span></code>,
and/or <code class="docutils literal notranslate"><span class="pre">edge</span></code> as template parameters at compile time, we also
introduce as needed versions with runtime parameters appending <code class="docutils literal notranslate"><span class="pre">FA</span></code> to
the function name for “function-arguments.” For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FaceAreaFA</span><span class="p">(</span> <span class="n">const</span> <span class="nb">int</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">i</span><span class="p">);</span> <span class="o">//</span><span class="n">Face</span> <span class="n">Areas</span>
</pre></div>
</div>
<p>This convention avoids naming conflicts between simplified functions and
runtime functions. These run-time versions are implemented on an
as-needed basis.</p>
<p><em>This page will be expanded with the implementation of spherical and
cylindrical coordinates.</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="constants.html" class="btn btn-neutral float-left" title="Parthenon Built-in Physical Constants" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="development.html" class="btn btn-neutral float-right" title="Parthenon developer guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Parthenon Collaboration and Triad National Security.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: develop
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="coordinates.html">develop</a></dd>
      <dd><a href="../../acreyes/div-free-prolong/src/coordinates.html">acreyes/div-free-prolong</a></dd>
      <dd><a href="../../acreyes/edge-flux-pack/src/coordinates.html">acreyes/edge-flux-pack</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview &mdash; Parthenon  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adaptive Mesh Refinement" href="amr.html" />
    <link rel="prev" title="Parthenon: A Performance Portable Block-Structured Adaptive Mesh Refinement Framework" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Parthenon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building-parthenon">Building parthenon</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description-of-examples">Description of examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#short-feature-descriptions">Short feature descriptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automated-tests">Automated tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage-in-downstream-codes">Usage in downstream codes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parthenonmanager">ParthenonManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-specified-internal-functions">User-specified internal functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mesh">Mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#meshblock">MeshBlock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#error-checking">Error checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developer-guide">Developer guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-management">State Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-drivers">Application Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-mesh-refinement">Adaptive Mesh Refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#meshblockdatas-and-meshblockdata-iterators">MeshBlockDatas and MeshBlockData Iterators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-shape-and-index-range">Index Shape and Index Range</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coordinates">Coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-file-parameter">Input file parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#global-reductions">Global reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solvers">Solvers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="amr.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html">Boundary communication-in-one concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html#sparse-boundary-communication">Sparse boundary communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts_lite.html">C++11 Style Concepts Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Parthenon Built-in Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinates.html">Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Parthenon developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Application Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrumentation.html">Performance Instrumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_balancing.html">Load Balancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="nested_par_for.html">Nested Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html">Parthenon Set-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html#parthenon-arbitrary-dimensional-arrays">Parthenon Arbitrary-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_manager.html">Parthenon Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="reductions.html">Task-based reductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx-doc.html">How to Use Sphinx for Writing Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">How to add tests to Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak_scaling.html">Running a Weak Scaling Test in Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/boundary.html">Boundary related classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/refinement_operations.html">Prolongation and Restriction Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/sparse.html">Sparse implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/state.html">State Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/mesh.html">Mesh</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Parthenon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h1>
<p>This file provides an overview of different (not necessarily all)
features in Parthenon and how to use them.</p>
<section id="building-parthenon">
<h2>Building parthenon<a class="headerlink" href="#building-parthenon" title="Link to this heading"></a></h2>
<p>See the <a class="reference internal" href="building.html#building"><span class="std std-ref">build doc</span></a> for details on building Parthenon
for specific systems.</p>
</section>
<section id="description-of-examples">
<h2>Description of examples<a class="headerlink" href="#description-of-examples" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/calculate_pi">Calculate π</a></p></li>
<li><p><a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/face_fields">Average face-centered variables to cell
centers</a></p></li>
<li><p><a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/stochastic_subgrid">Stochastic subgrid</a> Performs a
random amount of work per cell (drawn from a power law distribution)</p></li>
</ul>
</section>
<section id="short-feature-descriptions">
<h2>Short feature descriptions<a class="headerlink" href="#short-feature-descriptions" title="Link to this heading"></a></h2>
<section id="automated-tests">
<h3>Automated tests<a class="headerlink" href="#automated-tests" title="Link to this heading"></a></h3>
<p>Regression and convergence tests that cover the majority of features are
based on the <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/advection-example">Advection example</a> and
defined in the
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/tst/regression/test_suites/advection_convergence">advection-convergence</a>
and <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/tst/regression/test_suites/output_hdf5">output_hdf5</a> test
suites.</p>
<p>The tests currently cover</p>
<ul class="simple">
<li><p>advection of wave in x, y, and z direction
as well oblique to the <em>static</em> grid for different resolutions to
demonstrate first order convergence (see
<code class="docutils literal notranslate"><span class="pre">tst/regression/outputs/advection_convergence/advection-errors.png</span></code>
file in the build directory after running the test)</p></li>
<li><p>Advection of a smoothed sphere at an angle on a <em>static</em> grid, on a <em>static</em> grid a
twice the resolution, and with <em>AMR</em> covering the sphere at the
effective higher resolution</p></li>
<li><p>Advection of a sharp sphere at an angle
with <em>AMR</em> writing hdf5 output and comparing against a gold standard output.</p></li>
</ul>
<p>To execute the tests run, e.g.,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># from within the build directory (add -V fore more detailed output)</span>
ctest<span class="w"> </span>-R<span class="w"> </span>regression
</pre></div>
</div>
<p>The gold standard files (reference solutions) used in the regression
tests should automatically be downloaded during the configure phase.
Alternatively, you can download them as a release from
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/releases/">GitHub</a> and extract the
contents of the archive to
<code class="docutils literal notranslate"><span class="pre">PARTHENON_ROOT/tst/regression/gold_standard</span></code> directory. Make sure to
get the correct version matching your source (stored in the
<code class="docutils literal notranslate"><span class="pre">REGRESSION_GOLD_STANDARD_VER</span></code> CMake variable). Note: If you results
are (slightly) different, that may stem from using different
compiler/optimization options.</p>
<p>In case you adds new tests that require reference data just put all file
in the <code class="docutils literal notranslate"><span class="pre">PARTHENON_ROOT/tst/regression/gold_standard</span></code> directory and
either</p>
<ul class="simple">
<li><p>increase the version integer by one (both in the
<code class="docutils literal notranslate"><span class="pre">PARTHENON_ROOT/tst/regression/gold_standard/current_version</span></code> file and
in the <code class="docutils literal notranslate"><span class="pre">PARTHENON_ROOT/CMakeLists.txt</span></code> file), or</p></li>
<li><p>configure with
<code class="docutils literal notranslate"><span class="pre">REGRESSION_GOLD_STANDARD_SYNC=OFF</span></code>. The former is considered the
safer option as it prevents accidental overwriting of those files during
configure (as <code class="docutils literal notranslate"><span class="pre">REGRESSION_GOLD_STANDARD_SYNC</span></code> is <code class="docutils literal notranslate"><span class="pre">ON</span></code> by default).
In the pull request of the suggested changes we will then update the
official gold standard release file and appropriate hash prior to
merging.</p></li>
</ul>
<section id="usage-in-downstream-codes">
<h4>Usage in downstream codes<a class="headerlink" href="#usage-in-downstream-codes" title="Link to this heading"></a></h4>
<p>The easiest/recommended way to reuse the <code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> regression test
infrastructure in downstream codes is to adapt a similar directory
structure. The following steps have been tested to work when
<code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> is built from source in the downstream project
(specifically, the <code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> source is expected to be located in the
<code class="docutils literal notranslate"><span class="pre">external/parthenon</span></code> folder in the project’s root directory) :</p>
<ol class="arabic simple">
<li><p>Add the following to the downstream root <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> after
<code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> has been included:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="p">(</span><span class="n">CTest</span><span class="p">)</span>
<span class="n">add_subdirectory</span><span class="p">(</span><span class="n">tst</span><span class="o">/</span><span class="n">regression</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> regression tests should also be integrated
in the downstream testing, the binary output directory should only be
changed (e.g., via the <code class="docutils literal notranslate"><span class="pre">CMAKE_RUNTIME_OUTPUT_DIRECTORY</span></code> variable)
<em>after</em> <code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> has been included. Otherwise the paths to the
<code class="docutils literal notranslate"><span class="pre">Parthenon</span></code> regression test binaries will be wrong.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Create the following directories and files in the project folder (for an example
<code class="docutils literal notranslate"><span class="pre">my_first_test</span></code> test):</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tst</span><span class="o">/</span>
    <span class="n">regression</span><span class="o">/</span>
        <span class="n">CMakeLists</span><span class="o">.</span><span class="n">txt</span>
        <span class="n">test_suites</span><span class="o">/</span>
            <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>  <span class="c1"># &lt;-- empty file</span>
            <span class="n">my_first_test</span><span class="o">/</span>
                <span class="n">__init</span><span class="o">.</span><span class="n">py__</span>  <span class="c1"># &lt;-- empty file</span>
                <span class="n">my_first_test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Contents of <code class="docutils literal notranslate"><span class="pre">tst/regression/CMakeLists.txt</span></code></p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># import Parthenon setup_test_serial and setup_test_parallel
include(${PROJECT_SOURCE_DIR}/external/parthenon/cmake/TestSetup.cmake)

setup_test_serial(&quot;my_first_test&quot; &quot;--driver /path/to/downstream_binary \
  --driver_input ${PROJECT_SOURCE_DIR}/inputs/test_input_file.in --num_steps 3&quot; &quot;my_custom_test_label&quot;)
</pre></div>
</div>
<p>The same options for <code class="docutils literal notranslate"><span class="pre">setup_test_serial</span></code> and <code class="docutils literal notranslate"><span class="pre">setup_test_parallel</span></code>
as described in Parthenon <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/tst/regression/CMakeLists.txt">here</a>
and <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/cmake/TestSetup.cmake">here</a> apply.</p>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">my_first_test.py</span></code> contains the same logic as any other test in Parthenon, see a
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/tst/egression/test_suites/advection_outflow/advection_outflow.py">simple</a>
or more
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/tst/egression/test_suites/advection_outflow/advection_outflow.py">complicated</a>
example.</p></li>
<li><p>Now <code class="docutils literal notranslate"><span class="pre">my_first_test</span></code> should be automatically executed when
running <code class="docutils literal notranslate"><span class="pre">ctest</span></code> from the build directory.</p></li>
</ol>
</section>
</section>
<section id="parthenonmanager">
<h3>ParthenonManager<a class="headerlink" href="#parthenonmanager" title="Link to this heading"></a></h3>
<p>This class provides a streamlined capability to write new applications
by providing a simple interface to initialize and finalize a simulation.
It’s usage is straightforward and demonstrated in the π
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/calculate_pi/calculate_pi.cpp">example</a>.</p>
<p>Initialization is mandatory and takes care of (including sanity checks)</p>
<ol class="arabic simple">
<li><p>initializing MPI (if enabled)</p></li>
<li><p>initializing Kokkos (including device setup)</p></li>
<li><p>parsing command line arguments and parameter input file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ProcessPackages</span></code> Constructs and returns a <code class="docutils literal notranslate"><span class="pre">Packages_t</span></code> object
that contains a listing of all the variables and their metadata
associated with each package.</p></li>
</ol>
<p>Application can chose between a single and double stage initialization:</p>
<ul class="simple">
<li><p>Single stage: <code class="docutils literal notranslate"><span class="pre">ParthenonInit(int</span> <span class="pre">argc,</span> <span class="pre">char</span> <span class="pre">*argv[])</span></code> includes steps 1-5 above.</p></li>
<li><p>Double stage: <code class="docutils literal notranslate"><span class="pre">ParthenonInitEnv(int</span> <span class="pre">argc,</span> <span class="pre">char</span> <span class="pre">*argv[])</span></code>
includes steps 1-3 and <code class="docutils literal notranslate"><span class="pre">ParthenonInitPackagesAndMesh()</span></code> includes steps
4 and 5. This double stage setup allows, for example, to control the
package’s behavior at runtime by setting the problem generator based on
a variable in the input file.</p></li>
</ul>
</section>
<section id="user-specified-internal-functions">
<h3>User-specified internal functions<a class="headerlink" href="#user-specified-internal-functions" title="Link to this heading"></a></h3>
<p>During a simulation, Parthenon calls a number of default internal
functions whose behavior can be redefined by an application. Currently,
these functions are, by class:</p>
<section id="mesh">
<h4>Mesh<a class="headerlink" href="#mesh" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InitUserMeshData</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ProblemGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PostInitialization</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PreStepUserWorkInLoop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PostStepUserWorkInLoop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UserWorkAfterLoop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UserMeshWorkBeforeOutput</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UserMeshWorkBeforeRestartOutput</span></code></p></li>
</ul>
</section>
<section id="meshblock">
<h4>MeshBlock<a class="headerlink" href="#meshblock" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InitApplicationMeshBlockData</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InitMeshBlockUserData</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ProblemGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PostInitialization</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UserWorkBeforeOutput</span></code></p></li>
</ul>
<p>To redefine these functions, the user sets the respective function
pointers in the ApplicationInput member app_input of the
ParthenonManager class prior to calling <code class="docutils literal notranslate"><span class="pre">ParthenonInit</span></code>. This is
demonstrated in the <code class="docutils literal notranslate"><span class="pre">main()</span></code> functions in the examples.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">ProblemGenerator</span></code>s (and <code class="docutils literal notranslate"><span class="pre">PostInitialization</span></code>s) of
<code class="docutils literal notranslate"><span class="pre">Mesh</span></code> and <code class="docutils literal notranslate"><span class="pre">MeshBlock</span></code> are mutually exclusive. Moreover, the <code class="docutils literal notranslate"><span class="pre">Mesh</span></code>
ones requires <code class="docutils literal notranslate"><span class="pre">parthenon/mesh/pack_size=-1</span></code> during initialization, i.e.,
all blocks on a rank need to be in a single pack. This allows to use MPI
reductions inside the function, for example, to globally normalize quantities.
The <code class="docutils literal notranslate"><span class="pre">parthenon/mesh/pack_size=-1</span></code> exists only during problem
initialization, i.e., simulations can be restarted with an arbitrary
<code class="docutils literal notranslate"><span class="pre">pack_size</span></code>. For an example of the <code class="docutils literal notranslate"><span class="pre">Mesh</span></code> version, see the <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/poisson/parthenon_app_inputs.cpp">Poisson
example</a>.</p>
</section>
</section>
<section id="error-checking">
<h3>Error checking<a class="headerlink" href="#error-checking" title="Link to this heading"></a></h3>
<p>Macros for causing execution to throw an exception are provided
<a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/src/utils/error_checking.hpp">here</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_REQUIRE(condition,</span> <span class="pre">message)</span></code> exits if the condition does not evaluate to true.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_REQUIRE_THROWS(condition,</span> <span class="pre">message)</span></code> throws a <code class="docutils literal notranslate"><span class="pre">std::runtime_error</span></code> exception if the condition does not evaluate to true.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_FAIL(message)</span></code> always exits.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_THROW(message)</span></code> throws a runtime error.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_DEBUG_REQUIRE(condition,</span> <span class="pre">message)</span></code> exits if the condition does not evaluate to true when in debug mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_DEBUG_REQUIRE_THROWS(condition,</span> <span class="pre">message)</span></code> throws if the condition does not evaluate to true when in debug mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_DEBUG_FAIL(message)</span></code> always exits when in debug mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PARTHENON_DEBUG_THROW(message)</span></code> throws a runtime error when in debug mode.</p></li>
</ul>
<p>All macros print the message, and filename and line number where the
macro is called. PARTHENON_REQUIRE also prints the condition. The macros
take a <code class="docutils literal notranslate"><span class="pre">std::string</span></code>, a <code class="docutils literal notranslate"><span class="pre">std::stringstream</span></code>, or a C-style string. As
a rule of thumb:</p>
<ul class="simple">
<li><p>Use the exception throwing versions in non-GPU,
non-performance critical code.</p></li>
<li><p>On GPUs and in performance-critical
sections, use the non-throwing versions and give them C-style strings.</p></li>
</ul>
</section>
<section id="developer-guide">
<h3>Developer guide<a class="headerlink" href="#developer-guide" title="Link to this heading"></a></h3>
<p>Please see the <a class="reference internal" href="development.html#development"><span class="std std-ref">full development guide</span></a> on how to use
Kokkos-based performance portable abstractions available within
Parthenon and how to write performance portable code.</p>
</section>
<section id="state-management">
<h3>State Management<a class="headerlink" href="#state-management" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="interface/state.html#state"><span class="std std-ref">Full Documentation</span></a></p>
<p>Parthenon provides a convenient means of managing simulation data.
Variables can be registered with Parthenon to have the framework
automatically manage the field, including updating ghost cells,
prolongation, restriction, and I/O.</p>
</section>
<section id="application-drivers">
<h3>Application Drivers<a class="headerlink" href="#application-drivers" title="Link to this heading"></a></h3>
<p>A description of the Parthenon-provided classes that facilitate
developing the high-level functionality of an application (e..g. time
stepping) can be found <a class="reference internal" href="driver.html#driver"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="adaptive-mesh-refinement">
<h3>Adaptive Mesh Refinement<a class="headerlink" href="#adaptive-mesh-refinement" title="Link to this heading"></a></h3>
<p>A description of how to enable and extend the AMR capabilities of
Parthenon is provided <a class="reference internal" href="amr.html#amr"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Link to this heading"></a></h3>
<p>The tasking capabilities in Parthenon are documented
<a class="reference internal" href="tasks.html#tasks"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Link to this heading"></a></h3>
<p>Check <a class="reference internal" href="outputs.html#outputs"><span class="std std-ref">here</span></a> for a description of how to get data out of
Parthenon and how to visualize it.</p>
</section>
<section id="meshblockdatas-and-meshblockdata-iterators">
<h3>MeshBlockDatas and MeshBlockData Iterators<a class="headerlink" href="#meshblockdatas-and-meshblockdata-iterators" title="Link to this heading"></a></h3>
<p>See <a class="reference internal" href="interface/containers.html#containers"><span class="std std-ref">here</span></a> for a description of containers,
container iterators, and variable packs.</p>
</section>
<section id="index-shape-and-index-range">
<h3>Index Shape and Index Range<a class="headerlink" href="#index-shape-and-index-range" title="Link to this heading"></a></h3>
<p>A description of mesh indexing classes <a class="reference internal" href="mesh/domain.html#domain"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="coordinates">
<h3>Coordinates<a class="headerlink" href="#coordinates" title="Link to this heading"></a></h3>
<p>Accessing coordinate information on each block is described
<a class="reference internal" href="coordinates.html#coordinates"><span class="std std-ref">here</span></a>. Currently only uniform Cartesian coordinates
are supported in Parthenon but uniform Spherical and cylindrical
coordinates specified at compile time are forthcoming.</p>
</section>
<section id="input-file-parameter">
<h3>Input file parameter<a class="headerlink" href="#input-file-parameter" title="Link to this heading"></a></h3>
<p>An overview of input file parameters <a class="reference internal" href="inputs.html#inputs"><span class="std std-ref">here</span></a></p>
<p>Note that all parameters can be overridden (or new parameters added)
through the command line by appending the parameters to the launch
command. For example, the <code class="docutils literal notranslate"><span class="pre">refine_tol</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">&lt;parthenon/refinement0&gt;</span></code> block in the input file can be changed by
appending <code class="docutils literal notranslate"><span class="pre">parthenon/refinement0/refine_tol=my_new_value</span></code> to the
launch command (e.g.,
<code class="docutils literal notranslate"><span class="pre">srun</span> <span class="pre">./myapp</span> <span class="pre">-i</span> <span class="pre">my_input.file</span> <span class="pre">parthenon/refinement0/refine_tol=my_new_value</span></code>).
This similarly applies to simulations that are restarted, where modifications
from the command line and through an input file are possible, e.g.,
<code class="docutils literal notranslate"><span class="pre">srun</span> <span class="pre">./myapp</span> <span class="pre">-r</span> <span class="pre">out0.rhdf</span> <span class="pre">-i</span> <span class="pre">modified_input.in</span> <span class="pre">parthenon/refinement0/refine_tol=my_new_value</span></code>.
In the latter case, the input stored in the restart file will be read first,
then updated from the content in the input file, and finally modified from the
parameters provided on the command line.</p>
</section>
<section id="global-reductions">
<h3>Global reductions<a class="headerlink" href="#global-reductions" title="Link to this heading"></a></h3>
<p>Global reductions are a common need for downstream applications and can
be accomplished within Parthenon’s task-based execution as described
<a class="reference internal" href="reductions.html#reductions"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="solvers">
<h3>Solvers<a class="headerlink" href="#solvers" title="Link to this heading"></a></h3>
<p>Solvers are still a work in progress in Parthenon, but some basic
building blocks are described <a class="reference internal" href="solvers.html#solvers"><span class="std std-ref">here</span></a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Parthenon: A Performance Portable Block-Structured Adaptive Mesh Refinement Framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="amr.html" class="btn btn-neutral float-right" title="Adaptive Mesh Refinement" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Parthenon Collaboration and Triad National Security.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: acreyes/div-free-prolong
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../develop/src/README.html">develop</a></dd>
      <dd><a href="README.html">acreyes/div-free-prolong</a></dd>
      <dd><a href="../../edge-flux-pack/src/README.html">acreyes/edge-flux-pack</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
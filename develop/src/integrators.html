<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Integrators &mdash; Parthenon  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Load Balancing" href="load_balancing.html" />
    <link rel="prev" title="Performance Instrumentation" href="instrumentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Parthenon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="amr.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html">Boundary communication-in-one concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html#sparse-boundary-communication">Sparse boundary communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts_lite.html">C++11 Style Concepts Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Parthenon Built-in Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinates.html">Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Parthenon developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Application Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrumentation.html">Performance Instrumentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Integrators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stagedintegrator">StagedIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lowstorageintegrator">LowStorageIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#butcherintegrator">ButcherIntegrator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="load_balancing.html">Load Balancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="nested_par_for.html">Nested Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html">Parthenon Set-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html#parthenon-arbitrary-dimensional-arrays">Parthenon Arbitrary-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_manager.html">Parthenon Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="reductions.html">Task-based reductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx-doc.html">How to Use Sphinx for Writing Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">How to add tests to Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak_scaling.html">Running a Weak Scaling Test in Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/boundary.html">Boundary related classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/refinement_operations.html">Prolongation and Restriction Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/sparse.html">Sparse implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/state.html">State Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/mesh.html">Mesh</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Parthenon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Integrators</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/integrators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="integrators">
<span id="id1"></span><h1>Integrators<a class="headerlink" href="#integrators" title="Link to this heading"></a></h1>
<p>Integrators contain useful properties for writing a time-integration
scheme. They are defined in a class hierarchy. <code class="docutils literal notranslate"><span class="pre">MultiStageDriver</span></code>
owns a pointer to an integrator. The type of integrator depends on the
template parameter. By default it is the base class, and you can
assign child integrator you like, but you must cast the pointer at
runtime to access useful features of the child classes. Alternatively
if you inherit from <code class="docutils literal notranslate"><span class="pre">MultiStageDriver</span></code> and specialize to a specific
child class, you can avoid doing the cast.</p>
<section id="stagedintegrator">
<h2>StagedIntegrator<a class="headerlink" href="#stagedintegrator" title="Link to this heading"></a></h2>
<p>The base class is the <code class="docutils literal notranslate"><span class="pre">StagedIntegrator</span></code>. It contains a timestep
<code class="docutils literal notranslate"><span class="pre">dt</span></code>, a total number of integration steps, <code class="docutils literal notranslate"><span class="pre">nstages</span></code>, a total
number of scratch buffers required, <code class="docutils literal notranslate"><span class="pre">nbuffers</span></code>, and lists of strings
containing suggested names for the stages and buffers, <code class="docutils literal notranslate"><span class="pre">buffer_name</span></code>
and <code class="docutils literal notranslate"><span class="pre">stage_name</span></code>. All other integrators inherit from this one.</p>
</section>
<section id="lowstorageintegrator">
<h2>LowStorageIntegrator<a class="headerlink" href="#lowstorageintegrator" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">LowStorageIntegrator</span></code> contains integrators in the 2S form as
described in <a class="reference external" href="https://doi.org/10.1016/j.jcp.2009.11.006">Ketchson (2010)</a>. These integrators are of the classic
<a class="reference external" href="https://doi.org/10.1016/0021-9991(88)90177-5">Shu Osher</a> form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{(0)} &amp;= u^n \\
u^{(i)} &amp;= \sum_{k=0}^{i-1} (\alpha_{i,k} u^{(k)} + \Delta t \beta_{i, k} F(u^{(k)})\\
u^{n+1} &amp;= u^{(m)}\end{split}\]</div>
<p>where superscripts in parentheses mean subcycles in a Runge-Kutta
integration and <span class="math notranslate nohighlight">\(F\)</span> is the right-hand-side of ODE system. The
difference between these low-storage methods and the classic SSPK
methods is that the low-storage methods typically have sparse
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> matrices, which are replaced by
diagonal termes, named <span class="math notranslate nohighlight">\(\gamma_0\)</span> and <span class="math notranslate nohighlight">\(\gamma_1\)</span>
respectively.</p>
<p>These methods can be generalized to support more general methods with
the introduction of an additional <span class="math notranslate nohighlight">\(\delta\)</span> term for first
averaging the updated stage with previous stages. This form is also described in Section 3.2.3 of the <a class="reference external" href="https://doi.org/10.3847/1538-4365/ab929b">Athena++ paper</a>.</p>
<p>The full update then takes the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{(1)} &amp;:= u^{(1)} + \delta_s u^{(0)} \\
u^{(0)} &amp;:= \gamma_{s0} u^{(0)} + \gamma_{s1} u^{(1)} + \beta_{s,s-1} \Delta t F(u^{(0)})\end{split}\]</div>
<p>where here <span class="math notranslate nohighlight">\(u^{(0)}\)</span> and <span class="math notranslate nohighlight">\(u^{(1)}\)</span> are the two storage
buffers required to compute the update for a given Runge-Kutta stage
<span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LowStorageIntegrator</span></code> contains arrays for <code class="docutils literal notranslate"><span class="pre">delta</span></code>, <code class="docutils literal notranslate"><span class="pre">beta</span></code>,
<code class="docutils literal notranslate"><span class="pre">gam0</span></code>, and <code class="docutils literal notranslate"><span class="pre">gam1</span></code>. Available integration methods are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RK1</span></code>, which is simply forward Euler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK2</span></code>, which is Heun’s method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VL2</span></code>, 2nd-order Van Leer predictor-corrector from Stone and
Gardiner 2009. Requires donor-cell reconstruction for the predictor
stage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK3</span></code>, a strong stability preserving variant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code>, a strong stability preserving variant.</p></li>
</ul>
</section>
<section id="butcherintegrator">
<h2>ButcherIntegrator<a class="headerlink" href="#butcherintegrator" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ButcherIntegrator</span></code> provides a classic Butcher Tableau with
arrays <span class="math notranslate nohighlight">\(a\)</span> to compute the stages, <span class="math notranslate nohighlight">\(c\)</span> to compute the time
offsets, and <span class="math notranslate nohighlight">\(b\)</span> to compute the final update for a time
step. Available integration methods are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RK1</span></code>, simple forward Euler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK2</span></code>, Heun’s method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code>, The classic 4th-order method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RK10</span></code>, A recent version with fewer stages than Fehlberg’s classic RK8(9), computed by Faegin and tabulated <a class="reference external" href="https://sce.uhcl.edu/rungekutta/">here</a>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="instrumentation.html" class="btn btn-neutral float-left" title="Performance Instrumentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="load_balancing.html" class="btn btn-neutral float-right" title="Load Balancing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Parthenon Collaboration and Triad National Security.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: develop
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="integrators.html">develop</a></dd>
      <dd><a href="../../acreyes/div-free-prolong/src/integrators.html">acreyes/div-free-prolong</a></dd>
      <dd><a href="../../acreyes/edge-flux-pack/src/integrators.html">acreyes/edge-flux-pack</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
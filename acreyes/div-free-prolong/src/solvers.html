<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solvers &mdash; Parthenon  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to Use Sphinx for Writing Docs" href="sphinx-doc.html" />
    <link rel="prev" title="Task-based reductions" href="reductions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Parthenon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="amr.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html">Boundary communication-in-one concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_communication.html#sparse-boundary-communication">Sparse boundary communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts_lite.html">C++11 Style Concepts Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Parthenon Built-in Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinates.html">Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Parthenon developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Application Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrumentation.html">Performance Instrumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_balancing.html">Load Balancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="nested_par_for.html">Nested Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html">Parthenon Set-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_arrays.html#parthenon-arbitrary-dimensional-arrays">Parthenon Arbitrary-Dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="parthenon_manager.html">Parthenon Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="reductions.html">Task-based reductions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Solvers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stencil">Stencil</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sparsematrixaccessor">SparseMatrixAccessor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sphinx-doc.html">How to Use Sphinx for Writing Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">How to add tests to Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak_scaling.html">Running a Weak Scaling Test in Parthenon</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/boundary.html">Boundary related classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/refinement_operations.html">Prolongation and Restriction Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/sparse.html">Sparse implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface/state.html">State Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh/mesh.html">Mesh</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Parthenon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Solvers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/solvers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="solvers">
<span id="id1"></span><h1>Solvers<a class="headerlink" href="#solvers" title="Link to this heading"></a></h1>
<p>Parthenon does not yet provide an exhaustive set of plug and play solvers.
Nevertheless, the building blocks required for implementing Krylov subspace
methods (i.e. global reductions for vector dot products) like CG, BiCGStab,
and GMRES are available. An example of a Parthenon based implementation of
BiCGStab can be found in <code class="docutils literal notranslate"><span class="pre">examples/poisson_gmg</span></code>. Additionally, the
infrastructure required for implementing multigrid solvers is also
included in Parthenon. The requisite hierarchy of grids is produced if
<code class="docutils literal notranslate"><span class="pre">parthenon/mesh/multigrid=true</span></code> is set in the parameter input. An example
of a multi-grid based linear solver in Parthenon is also given in
<code class="docutils literal notranslate"><span class="pre">examples/poisson_gmg</span></code> (and also an example of using multi-grid as a
preconditioner for BiCGStab). We plan to build wrappers that simplify the
use of these methods in down stream codes in the future. Note that the
example code does not currently rely on the Stencil and SparseMatrixAccessor
code described below.</p>
<section id="stencil">
<h2>Stencil<a class="headerlink" href="#stencil" title="Link to this heading"></a></h2>
<p>This class provides a very simple and efficient means of storing a
sparse matrix with the special form that every row has identical entries
relative to the matrix diagonal. A good example of this is in the
straightforward finite difference discretization of the Poisson equation
(see <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/poisson/poisson_package.cpp">here</a> for example
usage). The <code class="docutils literal notranslate"><span class="pre">Stencil</span></code> object is extremely efficient at storing these
sparse matrices because it only has to store the matrix values and
offsets from the diagnonal for a single row. The <code class="docutils literal notranslate"><span class="pre">Stencil</span></code> class
provides member functions to compute matrix vector products (<code class="docutils literal notranslate"><span class="pre">MatVec</span></code>)
and Jacobi iterates (<code class="docutils literal notranslate"><span class="pre">Jacobi</span></code>). Both are designed to be called from
within kernels and operate on a single matrix row at a time.</p>
</section>
<section id="sparsematrixaccessor">
<h2>SparseMatrixAccessor<a class="headerlink" href="#sparsematrixaccessor" title="Link to this heading"></a></h2>
<p>This is a helper class that allows one to store a more general sparse
matrix than <code class="docutils literal notranslate"><span class="pre">Stencil</span></code> provides. Like <code class="docutils literal notranslate"><span class="pre">Stencil</span></code>, the
<code class="docutils literal notranslate"><span class="pre">SparseMatrixAccessor</span></code> class assumes that the location of the nonzero
matrix elements have fixed offsets from the diagonal in every row. Here,
though, the values of the matrix elements can be different from row to
row. The sparse matrix itself can be stored in a normal
<a class="reference internal" href="interface/state.html#cell-var"><span class="std std-ref">Variable</span></a> with the number of components
equal to the number of nonzero elements in a row of the matrix. The
<code class="docutils literal notranslate"><span class="pre">SparseMatrixAccessor</span></code> class than associates each of these components
with a particular matrix element. Like <code class="docutils literal notranslate"><span class="pre">Stencil</span></code>, the
<code class="docutils literal notranslate"><span class="pre">SparseMatrixAccessor</span></code> class provides <code class="docutils literal notranslate"><span class="pre">MatVec</span></code> and <code class="docutils literal notranslate"><span class="pre">Jacobi</span></code> member
functions. A simple demonstration of usage can be found in the <a class="reference external" href="https://github.com/parthenon-hpc-lab/parthenon/blob/develop/example/poisson/poisson_package.cpp">Poisson
example</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reductions.html" class="btn btn-neutral float-left" title="Task-based reductions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sphinx-doc.html" class="btn btn-neutral float-right" title="How to Use Sphinx for Writing Docs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Parthenon Collaboration and Triad National Security.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: acreyes/div-free-prolong
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../develop/src/solvers.html">develop</a></dd>
      <dd><a href="solvers.html">acreyes/div-free-prolong</a></dd>
      <dd><a href="../../edge-flux-pack/src/solvers.html">acreyes/edge-flux-pack</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>